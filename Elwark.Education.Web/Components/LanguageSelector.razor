@using Elwark.Education.Web.Infrastructure.LanguageStorage

<MudMenu
    Label="@_cultures[CultureInfo.CurrentCulture.Name.ToLowerInvariant()]"
    StartIcon="@Icons.Filled.Translate"
    Color="Color.Inherit"
    OffsetY="true"
    Direction="Direction.Top">
    @foreach (var (culture, name) in _cultures)
    {
        <MudMenuItem OnClick="@(() => Set(culture))">
            @name
        </MudMenuItem>
    }
</MudMenu>

@code {

    [Inject]
    private ILanguageStorage LanguageStorage { get; set; } = default!;

    [Inject]
    private NavigationManager NavigationManager { get; set; } = default!;

    private Dictionary<string, string> _cultures = new()
    {
        ["en-us"] = "English (US)",
        ["en-gb"] = "English (UK)",
        ["ru-ru"] = "Русский"
    };

    private async Task Set(string language)
    {
        await LanguageStorage.SetAsync(language);
        NavigationManager.NavigateTo(NavigationManager.Uri, true);
    }

}
