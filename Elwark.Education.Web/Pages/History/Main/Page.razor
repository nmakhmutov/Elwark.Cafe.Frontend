@page "/history"
@using Elwark.Education.Web.Gateways.History
@using Elwark.Education.Web.Gateways.History.Home

@attribute [Authorize]

<PageHeader Class="mb-12"/>
<ApiResponseViewer Response="@_response">
    <Placeholder>
        <CenteredContainer MaxWidth="@ContainerWidth.W1280" Class="mb-12">
            <DefaultFitGrid>
                <SkeletonCard/>
                <SkeletonCard/>
                <SkeletonCard/>
                <SkeletonCard/>
                <SkeletonCard/>
                <SkeletonCard/>
            </DefaultFitGrid>
        </CenteredContainer>
    </Placeholder>
    <Result Context="overview">
        <Title Value="@L["Subject:History"]"></Title>

        <CenteredContainer MaxWidth="@ContainerWidth.W1280" Class="mb-12">
            <div class="header">
                <MudText Typo="Typo.h6">
                    @L["Topics:Trending"]
                </MudText>
            </div>
            <Trending Items="@overview.TrendingTopics"/>
        </CenteredContainer>

        @* <section class="section mb-12 mx-3"> *@
        @*     <RandomTopic/> *@
        @* </section> *@

        <CenteredContainer MaxWidth="@ContainerWidth.W1600" Class="mb-12" Style="background-color: var(--mud-palette-black)">
            <DailyTopic Topic="@overview.DailyTopic" Class="mx-3 my-6"/>
        </CenteredContainer>

        <CenteredContainer MaxWidth="@ContainerWidth.W1280" Class="mb-12">
            <div class="header">
                <MudText Typo="Typo.h6">
                    @L["Topics:Hot"]
                </MudText>
            </div>
            <Trending Items="@overview.HotTopics"/>
        </CenteredContainer>

        @* <section class="section mb-12 mx-3"> *@
        @*     <RandomTopic/> *@
        @* </section> *@

        <CenteredContainer MaxWidth="@ContainerWidth.W1280" Class="mb-12">
            <div class="header">
                <MudText Typo="Typo.h6">
                    @L["Topics:Recent"]
                </MudText>
            </div>
            <Trending Items="@overview.RecentTopics"/>
        </CenteredContainer>
    </Result>
</ApiResponseViewer>
<CenteredContainer MaxWidth="@ContainerWidth.W960">
    <RandomTopic/>
</CenteredContainer>

@code {

    private ApiResponse<HistoryOverview> _response = ApiResponse<HistoryOverview>.Loading();

    [Inject]
    private IHistoryClient Client { get; set; } = default!;

    [Inject]
    private IStringLocalizer<App> L { get; set; } = default!;

    protected override async Task OnInitializedAsync()
    {
        _response = await Client.Home.GetAsync();
    }

}
